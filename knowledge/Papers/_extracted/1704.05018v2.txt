FILE: 1704.05018v2.pdf
PAGES: 24
TITLE_GUESS: Hardware-eﬃcient Variational Quantum Eigensolver for Small Molecules and
ABSTRACT_EXTRACT:
[not found]
FIRST_PAGES_TEXT:
Hardware-eﬃcient Variational Quantum Eigensolver for Small Molecules and Quantum Magnets Abhinav Kandala,∗ Antonio Mezzacapo,∗ Kristan Temme, Maika Takita, Markus Brink, Jerry M. Chow, and Jay M. Gambetta IBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA (Dated: October 16, 2017) Quantum computers can be used to address molecular structure, materials science and con- densed matter physics problems, which currently stretch the limits of existing high-performance computing resources [1]. Finding exact numerical solutions to these interacting fermion problems has exponential cost, while Monte Carlo methods are plagued by the fermionic sign problem. These limitations of classical computational methods have made even few-atom molecular structures problems of practical interest for medium-sized quantum computers. Yet, thus far experi- mental implementations have been restricted to molecules involving only Period I elements [2– 8]. Here, we demonstrate the experimental op- timization of up to six-qubit Hamiltonian prob- lems with over a hundred Pauli terms, determin- ing the ground state energy for molecules of in- creasing size, up to BeH 2. This is enabled by a hardware-eﬃcient variational quantum eigen- solver with trial states speciﬁcally tailored to the available interactions in our quantum pro- cessor, combined with a compact encoding of fermionic Hamiltonians [9] and a robust stochas- tic optimization routine [10]. We further demon- strate the ﬂexibility of our approach by apply- ing the technique to a problem of quantum mag- netism [11]. Across all studied problems, we ﬁnd agreement between experiment and numeri- cal simulations with a noisy model of the device. These results help elucidate the requirements for scaling the method to larger systems, and aim at bridging the gap between problems at the fore- front of high-performance computing and their implementation on quantum hardware. The fundamental goal of addressing molecular struc- ture problems is to solve for the ground state energy of many-body interacting fermionic Hamiltonians. Solving this problem on a quantum computer relies on a mapping between fermionic and qubit operators [12]. This restates it as a speciﬁc instance of a local Hamiltonian problem on a set of qubits. Given a k-local Hamiltonian H, com- posed of terms that act on at most k qubits, the solution to the local Hamiltonian problem amounts to ﬁnding its ∗ These authors contributed equally to this work. smallest eigenvalue EG, H| Φ⟩ = EG| Φ⟩. (1) To date, no eﬃcient algorithm is known that can solve this problem in full generality. For k≥ 2 the problem is known to be QMA-complete [13]. However, it is expected that physical systems have Hamiltonians that do not con- stitute hard instances of this problem, and can be solved eﬃciently on a quantum computer, while remaining hard to solve classically. Following Feynman’s idea for quantum simulation, a quantum algorithm for the ground state problem of interacting fermions was proposed in [14] and [15]. The approach relies on a good initial state that has a large overlap with the ground state and then solves the problem using the quantum phase estimation algo- rithm (PEA) [16]. While PEA has been demonstrated to achieve extremely accurate energy estimates for quantum chemistry [2, 3, 5, 8], it applies stringent requirements on quantum coherence. An alternative approach is the use of quantum op- timizers. Their utility spans from combinatorial opti- mization problems [17, 18] to quantum chemistry in the form of variational quantum eigensolvers (VQEs), where they were introduced to reduce coherence requirements on quantum hardware [4, 19, 20]. The VQE uses Ritz’s variational principle to prepare approximations to the ground state and its energy. In this approach, the quan- tum computer is used to prepare variational trial states that depend on a set of parameters. Then, the expec- tation value of the energy is estimated and used by a classical optimizer to generate a new set of improved pa- rameters. The advantage of VQE over classical simula- tion methods is that is can prepare trial states that are not amenable to eﬃcient classical numerics. To date, the VQE approach realized in experiment has been limited by diﬀerent factors. Typically, one con- siders a unitary coupled cluster (UCC) ansatz for the trial state [6, 7], which has a number of parameters that scale quartically with the number of spin-orbitals con- sidered, in the single and double excitation approxima- tion. Furthermore, when implementing the UCC ansatz on a quantum computer, one has to account for Trot- terization errors [20–22]. In this work, we introduce and implement a “hardware-eﬃcient” ansatz preparation for VQE, where trial states are parameterized by quantum gates that are tailored to the physical device available. We numerically show the viability of such trial states for arXiv:1704.05018v2 [quant-ph] 13 Oct 2017 2 FIG. 1. Quantum chemistry on a superconducting quantum processor: device and quantum circuit for variational trial state preparation. Solving molecular structure problems on a quantum computer relies on mappings between fermionic and qubit operators. a Parity mapping of 8 spin orbitals (drawn in blue and red, not to scale) onto 8 qubits, reduced to 6 qubits via qubit tapering of fermionic spin-parity symmetries. The bars indicate the parity of the spin-orbitals encoded in each qubit. b False colored optical micrograph of the superconducting quantum processor. The transmon qubits are coupled via two CPW resonators, highlighted in blue, and have individual CPW resonators for control and readout. c Hardware-eﬃcient quantum circuit for trial state preparation and energy estimation, shown here for 6 qubits. The circuit is composed of a sequence of interleaved single-qubit rotations, and entangling unitary operations UENT that entangle all the qubits in the circuit. A ﬁnal set of post-rotations prior to qubit readout are used to measure the expectation values of the terms in the qubit Hamiltonian, and estimate the energy of the trial state. d An example of the pulse sequence for the preparation of a six qubit trial state, where UENT is implemented as a sequence of two-qubit cross resonance gates. small molecular structure problems and use a supercon- ducting quantum processor to perform optimizations of the molecular energies of H 2, LiH and BeH 2, and extend its application to a Heisenberg antiferromagnetic model in an external magnetic ﬁeld. The device used in the experiments is a superconduct- ing quantum processor with six ﬁxed-frequency transmon qubits, together with a central weakly-tunable asymmet- ric transmon qubit [23]. The device is cooled down in a dilution refrigerator, thermally anchored to its mixing chamber plate at 25 mK. The experiments discussed here make use of six of these qubits (labeled Q1-6), highlighted in Fig. 1b. The qubits are coupled via two superconduct- ing coplanar waveguide (CPW) resonators that serve as quantum buses, and can be individually controlled and read out through independent readout resonators. The hardware-eﬃcient trial states we consider use the naturally available entangling interactions of the super- conducting hardware, described by a drift Hamiltonian H0 that generates the entanglers UENT = exp(−iH0τ) which entangle all the qubits in the circuit. These are interleaved with arbitrary single-qubit Euler rotations which are implemented as a combination of Z and X gates, given by Uq,i(⃗θ) = Zq θq,i 1 Xq θq,i 2 Zq θq,i 3 , where q identi- ﬁes the qubit and i = 0 , 1, ...d refers to the depth posi- tion, as depicted in Fig. 1c. The N-qubit trial states are obtained from the state | 00 . . .0⟩, applying d entanglers UENT that alternate with N Euler rotations, giving | Φ(⃗θ)⟩ = N∏ q=1 [ Uq,d(⃗θ) ] × UENT× N∏ q=1 [ Uq,d−1(⃗θ) ] ···× UENT× N∏ q=1 [ Uq,0(⃗θ) ] | 00...0⟩. (2) Since the qubits are all initialized in their ground state | 0⟩, the ﬁrst set of Z rotations of Uq,0(⃗θ) is not imple- mented, resulting in a total of p = N(3d + 2) indepen- dent angles. In the experiment, the evolution time τ and the individual couplings in H0 can be controlled. 3 0 50 100 150 200 250 Iteration -15.6 -15.4 -15.2 -15 -14.8 -14.6 -14.4 -14.2 -14 -13.8 -13.6Energy (Hartree) E(~3final) E(~3+ k) E(~3! k) Exact Final Exp. Result 0 100200 Iteration -: -:/2 0 :/2 : 3j q,i,' Xq(32 q,0,') 0 100200 Iteration Zq(33 q,0,') 0 100200 Iteration Zq(31 q,1,') 0 100200 Iteration Xq(32 q,1,') 0 100200 Iteration Zq(33 q,1,') FIG. 2. Experimental implementation of six-qubit optimization. Energy minimization for the six-qubit Hamil- tonian describing BeH 2 at interatomic distance l = 1.7 ◦ A, plotted against the exact value (black dashed line). For each iteration k, the gradient at each control ⃗θk is approximated using 103 samples for energy estimations at ⃗θ+ k and ⃗θ− k , shown in blue and red, respectively. The inset shows the simultane- ous optimization of 30 Euler angles that control the trial state preparation. Each color refers to a particular qubit, following the qubit color scheme of Fig. 1. The ﬁnal energy estimate (green dashed line) is obtained using the angles ⃗θﬁnal, aver- aged over the last 25 angle updates, in order to mitigate the eﬀect of stochastic ﬂuctuations, with a higher number of 10 5 samples, to get a more accurate energy estimation. However, numerical simulations indicate that accurate optimizations are obtained for ﬁxed-phase UENT, leav- ing the p control angles as variational parameters . Our hardware-eﬃcient approach does not rely on the accu- rate implementation of speciﬁc two qubit gates and can be used with any UENT that generates suﬃcient entan- glement. This is in contrast to UCC trial states that require high-ﬁdelity quantum gates approximating a uni- tary operator tailored on a theoretical ansatz. For the experiments considered here, the entanglers UENT are composed of a sequence of two-qubit cross-resonance (CR) gates [24].Simulations as a function of entangler phase show plateaus of minimal energy error around gate phases corresponding to the maximal pairwise concur- rence, see Supplementary Information. We therefore set the entangler evolution time τ at the beginning of such plateaus, in order to reduce decoherence eﬀects. In our experiments, the Z rotations are implemented as frame changes in the control software [25], while theX ro- tations are implemented by appropriately scaling the am- plitude of calibrated Xπ pulses, using a ﬁxed total time of 100 ns for every single-qubit rotation. The CR c−t gates that compose UENT are implemented by driving a control qubit Qc with a microwave pulse resonant with a target qubit Qt. Hamiltonian tomography of the CR c−t gates is used to reveal the strengths of the various interaction terms, and the gate time for maximal entanglement [24]. We set our two-qubit gate times at 150 ns, simultaneously trying to minimize the eﬀect of decoherence without com- promising the accuracy of the optimization outcome, see Supplementary Information. After each trial state is prepared, we estimate the asso- ciated energy by measuring the expectation values of the individual Pauli terms in the Hamiltonian. These esti- mates are aﬀected by stochastic ﬂuctuations due to ﬁnite sampling. Diﬀerent post-rotations are applied after trial state preparation for sampling diﬀerent Pauli operators, see Fig. 1c,d. We group the Pauli operators into tensor product basis sets that require the same post-rotations. We numerically show that such grouping reduces the en- ergy ﬂuctuations, keeping the same total number of sam- ples, thereby reducing the time overhead for energy esti- mation, see Supplementary Information. The energy esti- mates are then used by a gradient descent algorithm that relies on a simultaneous perturbation stochastic approx- imation (SPSA) to update the control parameters. The SPSA algorithm approximates the gradient using only two energy measurements, regardless of the dimensions of the parameter space p, achieving a level of accuracy comparable to standard gradient descent methods, in the presence of stochastic ﬂuctuations [10]. This is a crucial aspect for optimizing over many qubits and long depths for trial state preparation, allowing us to optimize over a number of parameters as large as p = 30. To address molecular problems on our quantum pro- cessor, we rely on a compact encoding of the second- quantized fermionic Hamiltonians on to qubits. The H2 molecular Hamiltonian has 4 spin-orbitals, represent- ing the spin-degenerate 1 s orbitals of the two Hydrogen atoms. We use a binary tree encoding [12] to map it to a 4 qubit system, and remove two qubits associated with the spin-parities of the system [9]. The BeH 2 Hamilto- nian is deﬁned upon the 1 s, 2 s, 2 px orbitals associated to Be, and 1 s orbital associated to each H atom, for a total of 10 spin orbitals. We then assume perfect ﬁlling of the two innermost 1s spin-orbitals of Be, after dressing them via the diagonalization of the non-interacting part of the fermionic Hamiltonian. We map the 8 spin-orbital Hamiltonian of BeH2 spin-orbital Hamiltonian using the parity mapping, and remove, as in the case of H 2, two qubits associated to the spin-parity symmetries, reducing this to a 6 qubit problem that encodes 8 spin-orbitals. A similar approach is also used to map LiH onto 4 qubits. The Hamiltonians for H2, LiH and BeH2 at their equilib- rium distance are explicitly given in the Supplementary Information. The results from an optimization procedure are illus- trated in detail in Fig. 2, using the BeH2 Hamiltonian for the interatomic distance of 1.7 ◦ A. It is important to note that while using a large number of entanglers UENT helps achieve better energy estimates in the absence of noise, the combined eﬀect of decoherence and ﬁnite sampling 4 0 1 2 3 4 Interatomic distance (Angstrom) -1.2 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 Energy (Hartree) 0 50 100 1 2 3 4 5 Interatomic distance (Angstrom) -8 -7.8 -7.6 -7.4 -7.2 -7 -6.8 -6.6Energy (Hartree) 0 20 40 CR2-4 CR1-3 CR2-1 Q1 Q2 Q3Q4Q5 Q7 Q6 CR2-4 Q1 Q2 Q3Q4Q5 Q7 Q6 H H H Li 1 2 3 4 5 Interatomic distance (Angstrom) -15.5 -15 -14.5 -14 -13.5 -13 -12.5 -12 Energy (Hartree) 0 20 40 CR2-4 CR1-3 CR2-1CR4-5 CR6-5 Q1 Q2 Q3Q4Q5 Q7 Q6 Be H H a b c FIG. 3. Application to quantum chemistry: Potential energy surfaces Experimental results (black circles), exact energy surfaces (dotted lines) and density plots of outcomes from numerical simulations, for a number of interatomic distances for a, H2 b, LiH, and c, BeH2. The experimental and numerical results presented here use depth d = 1 circuits. The error bars on the experimental data are smaller than the size of the markers. The density plots are obtained from 100 numerical outcomes at each interatomic distance. The top insets of each ﬁgure highlight the qubits used for the experiment, and the cross-resonance gates that constituteUENT. The bottom insets of each ﬁgure are representations of the molecular geometry, not drawn to scale. For all the three molecules, the deviation of the experimental results from the exact curves, is well explained by the stochastic simulations. sets the optimal depth for optimizations on our quantum hardware to 0 − 2 entanglers. The results presented in Fig. 2 are obtained using a depth d = 1 circuit, with a total of 30 Euler control angles associated with 6 qubits. The inset of Fig. 2 shows the simultaneous perturbation of 30 Euler angles, as the energy estimates are updated. To obtain the potential energy surfaces for H 2, LiH, and BeH2, we search for the ground state energy of their molecular Hamiltonians, using 2, 4, and 6 qubits respec- tively, for depth d = 1, for a range of diﬀerent inter- atomic distances. The experimental results are compared with the ground state energies obtained from exact di- agonalization and outcomes from numerical simulations in Fig. 3. The colored density plots in each panel are obtained from 100 numerical optimizations for each in- teratomic distance, using CR entangling gates on the same topology as the experiments. These numerics ac- count for decoherence eﬀects, simulated by adding am- plitude damping and dephasing channels after each layer of quantum gates. The impact of ﬁnite sampling on the optimization algorithm is taken into account by numer- ically sampling the individual Pauli terms in the Hamil- tonian, and adding their averages. The strengths of the noise channels are derived from the measured values for T1, T∗ 2 coherence times. In addition to the eﬀects of decoherence and noisy energy estimates, the deviations are also due to low circuit depth for trial state prepara- tion, which, for example, explains the kink in the range l = 2.5− 3 ◦ A, in Fig. 3b. In the absence of noise, criti- cal depths of d = 1, 8, 28(1, 6, 16) are required to achieve chemical accuracy (approx. 0.0016 Hartree), on the cur- rent experimental (all-to-all) connectivities for H 2, LiH and BeH2, respectively, see Supplementary Information. In contrast, a generic UCC ansatz truncated to the sec- ond order for a 8-orbital molecule such as our model of BeH2 would require 4160 fermionic variational terms, which, after accounting for fermionic mappings and Trot- terization would generate a number of quantum gates of the same order. The scaling of resources and noise re- quirements to achieve chemical accuracy using hardware- eﬃcient trial states are detailed in the Supplementary In- formation. We emphasize that our approach is unaﬀected by coherent gate errors, which shifts the focus to the re- duction of incoherent errors, favoring our ﬁxed-frequency, all-microwave control, qubit architecture. Furthermore, the eﬀect of incoherent errors can be mitigated as recently proposed [26–28], without requiring additional quantum resources. We now demonstrate the applicability of our technique to a problem of quantum magnetism, and show that with the same